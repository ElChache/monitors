{"version":3,"file":"connection-D27Xdyu3.js","sources":["../../../.svelte-kit/adapter-node/chunks/connection.js"],"sourcesContent":["import { drizzle } from \"drizzle-orm/node-postgres\";\nimport { Pool } from \"pg\";\nimport { config } from \"dotenv\";\nimport { n as notificationSchema, b as monitorSchema, c as userSchema } from \"./users.js\";\nconfig();\nconst pool = new Pool({\n  connectionString: process.env.DATABASE_URL || `postgresql://${process.env.DATABASE_USER}:${process.env.DATABASE_PASSWORD}@${process.env.DATABASE_HOST}:${process.env.DATABASE_PORT}/${process.env.DATABASE_NAME}`,\n  max: 10,\n  // Maximum number of connections in pool\n  idleTimeoutMillis: 3e4,\n  // Close idle connections after 30 seconds\n  connectionTimeoutMillis: 2e3\n  // Timeout after 2 seconds\n});\npool.on(\"error\", (err) => {\n  console.error(\"Unexpected database pool error:\", err);\n});\nconst db = drizzle(pool, {\n  schema: {\n    ...userSchema,\n    ...monitorSchema,\n    ...notificationSchema\n  }\n});\nprocess.on(\"SIGINT\", async () => {\n  await pool.end();\n  process.exit(0);\n});\nprocess.on(\"SIGTERM\", async () => {\n  await pool.end();\n  process.exit(0);\n});\nexport {\n  db,\n  pool\n};\n"],"names":[],"mappings":";;;;;;;AAIA,MAAM,EAAE;AACH,MAAC,IAAI,GAAG,IAAI,IAAI,CAAC;AACtB,EAAE,gBAAgB,EAAE,OAAO,CAAC,GAAG,CAAC,YAAY,IAAI,CAAC,aAAa,EAAE,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC,EAAE,OAAO,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC,EAAE,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC,EAAE,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC,EAAE,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;AACnN,EAAE,GAAG,EAAE,EAAE;AACT;AACA,EAAE,iBAAiB,EAAE,GAAG;AACxB;AACA,EAAE,uBAAuB,EAAE;AAC3B;AACA,CAAC;AACD,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE,CAAC,GAAG,KAAK;AAC1B,EAAE,OAAO,CAAC,KAAK,CAAC,iCAAiC,EAAE,GAAG,CAAC;AACvD,CAAC,CAAC;AACG,MAAC,EAAE,GAAG,OAAO,CAAC,IAAI,EAAE;AACzB,EAAE,MAAM,EAAE;AACV,IAAI,GAAG,UAAU;AACjB,IAAI,GAAG,aAAa;AACpB,IAAI,GAAG;AACP;AACA,CAAC;AACD,OAAO,CAAC,EAAE,CAAC,QAAQ,EAAE,YAAY;AACjC,EAAE,MAAM,IAAI,CAAC,GAAG,EAAE;AAClB,EAAE,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;AACjB,CAAC,CAAC;AACF,OAAO,CAAC,EAAE,CAAC,SAAS,EAAE,YAAY;AAClC,EAAE,MAAM,IAAI,CAAC,GAAG,EAAE;AAClB,EAAE,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;AACjB,CAAC,CAAC;;;;"}