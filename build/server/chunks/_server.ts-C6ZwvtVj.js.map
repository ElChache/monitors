{"version":3,"file":"_server.ts-C6ZwvtVj.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/monitors/_id_/_server.ts.js"],"sourcesContent":["import { error, json } from \"@sveltejs/kit\";\nimport { z } from \"zod\";\nimport { m as monitorIdSchema, M as MonitorService, u as updateMonitorSchema } from \"../../../../../chunks/service5.js\";\nimport { J as JWTService } from \"../../../../../chunks/jwt.js\";\nconst GET = async ({ params, cookies }) => {\n  try {\n    const sessionToken = cookies.get(\"session\");\n    if (!sessionToken) {\n      throw error(401, \"Authentication required\");\n    }\n    const payload = JWTService.verifyAccessToken(sessionToken);\n    if (!payload) {\n      throw error(401, \"Invalid session token\");\n    }\n    const { id } = monitorIdSchema.parse(params);\n    const monitor = await MonitorService.getMonitorById(payload.userId, id);\n    if (!monitor) {\n      throw error(404, \"Monitor not found or access denied\");\n    }\n    return json({\n      success: true,\n      data: monitor\n    });\n  } catch (err) {\n    console.error(\"Get monitor error:\", err);\n    if (err instanceof z.ZodError) {\n      throw error(400, {\n        message: \"Invalid monitor ID\",\n        details: err.errors\n      });\n    }\n    if (err && typeof err === \"object\" && \"status\" in err) {\n      throw err;\n    }\n    throw error(500, \"Failed to retrieve monitor\");\n  }\n};\nconst PUT = async ({ params, request, cookies }) => {\n  try {\n    const sessionToken = cookies.get(\"session\");\n    if (!sessionToken) {\n      throw error(401, \"Authentication required\");\n    }\n    const payload = JWTService.verifyAccessToken(sessionToken);\n    if (!payload) {\n      throw error(401, \"Invalid session token\");\n    }\n    const { id } = monitorIdSchema.parse(params);\n    const data = await request.json();\n    const validatedData = updateMonitorSchema.parse(data);\n    const updatedMonitor = await MonitorService.updateMonitor(payload.userId, id, validatedData);\n    if (!updatedMonitor) {\n      throw error(404, \"Monitor not found or access denied\");\n    }\n    return json({\n      success: true,\n      message: \"Monitor updated successfully\",\n      data: updatedMonitor\n    });\n  } catch (err) {\n    console.error(\"Update monitor error:\", err);\n    if (err instanceof z.ZodError) {\n      throw error(400, {\n        message: \"Invalid update data\",\n        details: err.errors\n      });\n    }\n    if (err && typeof err === \"object\" && \"status\" in err) {\n      throw err;\n    }\n    throw error(500, \"Failed to update monitor\");\n  }\n};\nconst DELETE = async ({ params, cookies }) => {\n  try {\n    const sessionToken = cookies.get(\"session\");\n    if (!sessionToken) {\n      throw error(401, \"Authentication required\");\n    }\n    const payload = JWTService.verifyAccessToken(sessionToken);\n    if (!payload) {\n      throw error(401, \"Invalid session token\");\n    }\n    const { id } = monitorIdSchema.parse(params);\n    const deleted = await MonitorService.deleteMonitor(payload.userId, id);\n    if (!deleted) {\n      throw error(404, \"Monitor not found or access denied\");\n    }\n    return json({\n      success: true,\n      message: \"Monitor deleted successfully\"\n    });\n  } catch (err) {\n    console.error(\"Delete monitor error:\", err);\n    if (err instanceof z.ZodError) {\n      throw error(400, {\n        message: \"Invalid monitor ID\",\n        details: err.errors\n      });\n    }\n    if (err && typeof err === \"object\" && \"status\" in err) {\n      throw err;\n    }\n    throw error(500, \"Failed to delete monitor\");\n  }\n};\nexport {\n  DELETE,\n  GET,\n  PUT\n};\n"],"names":[],"mappings":"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"}