import{c as je,l as ze}from"../chunks/DY2n60aa.js";import"../chunks/B3U0dzdT.js";import{R as Qe,I as Ze,bl as et,bm as tt,p as Le,b3 as Ne,bn as Ue,l as me,aA as $e,q as e,g as Pe,c as rt,f as Be,a as A,b as _,d as Ie,m as E,u as h,F as k,v as L,i as c,j as r,k as i,z as t,t as X,r as S,y as ne,D as F,n as ye,o as He,bo as Je,C as Me,w as at,bd as st,A as Oe}from"../chunks/Dj_MzOAd.js";import{a as j}from"../chunks/DpAHg45Y.js";import{i as J}from"../chunks/Cuz_4TPC.js";import{e as Ee,i as Ve}from"../chunks/g81J5-kY.js";import{c as ot,s as We,a as nt}from"../chunks/ChDYIZxk.js";import{b as it}from"../chunks/Cfjr_KEZ.js";import{p as lt}from"../chunks/Bfc47y5P.js";import{i as Re}from"../chunks/C-FtVNBC.js";import{p as Ae,s as qe,a as Ye}from"../chunks/BQhR6swN.js";import{l as Ce}from"../chunks/C26VBlX9.js";import{g as ct}from"../chunks/CROSmZe9.js";import{w as dt}from"../chunks/Bz37txc7.js";function ut(U,B){Qe(()=>{const l=new Map,D=U(),z=Ze(D)?D:D==null?[]:Array.from(D),a=z.length;for(let p=0;p<a;p++){const m=B(z[p],p);if(l.has(m)){const R=String(l.get(m)),W=String(p);let x=String(m);x.startsWith("[object ")&&(x=null),et(R,W,x)}l.set(m,p)}})}const vt=tt;V[k]="src/lib/components/AIPromptSuggestions.svelte";var pt=j(L('<div class="animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"></div>'),V[k],[[172,8]]),ft=j(L('<div class="space-y-2"><div class="h-4 bg-blue-100 rounded animate-pulse"></div> <div class="h-4 bg-blue-100 rounded animate-pulse w-3/4"></div></div>'),V[k],[[177,6,[[178,8],[179,8]]]]),gt=j(L('<div class="bg-white border border-blue-200 rounded-lg p-3 relative group"><div class="flex items-start justify-between"><div class="flex-1"><div class="flex items-center space-x-2 mb-1"><span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800"> </span> <span class="text-xs text-gray-500"> </span></div> <h5 class="text-sm font-medium text-gray-900 mb-1"> </h5> <p class="text-xs text-gray-600 mb-2"> </p> <div class="bg-gray-50 rounded p-2 text-sm text-gray-700 font-mono text-xs"> </div> <p class="text-xs text-gray-500 mt-2 italic"> </p></div> <button type="button" class="ml-2 text-gray-400 hover:text-gray-600 opacity-0 group-hover:opacity-100 transition-opacity svelte-9i4mxp" aria-label="Dismiss suggestion"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div> <div class="flex justify-end space-x-2 mt-3"><button type="button" class="px-3 py-1 text-xs font-medium text-blue-700 bg-blue-100 border border-blue-300 rounded hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 transition-colors svelte-9i4mxp">Apply suggestion</button></div></div>'),V[k],[[184,10,[[185,12,[[186,14,[[187,16,[[188,18],[191,18]]],[196,16],[200,16],[204,16],[208,16]]],[213,14,[[219,16,[[220,18]]]]]]],[225,12,[[226,14]]]]]]),mt=j(L('<div class="space-y-3"></div>'),V[k],[[182,6]]),bt=j(L('<div class="mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg"><div class="flex items-center justify-between mb-3"><div class="flex items-center space-x-2"><svg class="w-4 h-4 text-blue-600" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg> <h4 class="text-sm font-medium text-blue-900"> </h4></div> <!></div> <!></div>'),V[k],[[160,2,[[161,4,[[162,6,[[163,8,[[164,10]]],[166,8]]]]]]]]);function V(U,B){je(new.target),Le(B,!1,V);const l=Ne();let D=Ae(B,"prompt",8,""),z=Ae(B,"error",12,""),a=E([]),p=E(!1),m=E(null);const R=async v=>{if(v.trim().length<20){c(a,[]);return}c(p,!0),z("");try{const y=(await ne(fetch("/api/ai/suggestions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:v,context:"monitor_creation"})})))();if(y.ok){const b=(await ne(y.json()))();c(a,b.suggestions||[])}else(await ne(new Promise(b=>setTimeout(b,800))))(),c(a,W(v))}catch{(await ne(new Promise(b=>setTimeout(b,800))))(),c(a,W(v))}finally{c(p,!1)}},W=v=>{const y=[],b=v.toLowerCase();return!b.includes("when")&&!b.includes("if")&&y.push({id:"spec_1",type:"specificity",title:"Add trigger condition",description:"Consider adding a specific condition to trigger your monitor",suggested_text:`${v} when [condition]`,confidence:.85,reasoning:"Monitors work better with specific trigger conditions"}),(b.includes("stock")||b.includes("price")||b.includes("$"))&&y.push({id:"stock_1",type:"improvement",title:"Specify price threshold",description:"Add a specific price point for better monitoring",suggested_text:v.includes("$")?v:`${v} below $[amount]`,confidence:.92,reasoning:"Stock monitors need specific price thresholds"}),(b.includes("weather")||b.includes("rain")||b.includes("snow"))&&y.push({id:"weather_1",type:"clarity",title:"Add location",description:"Weather monitors work better with specific locations",suggested_text:b.includes(" in ")?v:`${v} in [city]`,confidence:.88,reasoning:"Weather data requires location specificity"}),v.length>100&&y.push({id:"clarity_1",type:"clarity",title:"Simplify description",description:"Consider breaking this into multiple monitors for better accuracy",suggested_text:v.split(".")[0]||v.substring(0,80)+"...",confidence:.75,reasoning:"Simpler prompts often yield better results"}),y.slice(0,3)},x=v=>{l("apply-suggestion",{text:v.suggested_text,type:v.type})},s=v=>{c(a,e(a).filter(y=>ye(y.id,v,!1)))};Ue(()=>{e(m)&&clearTimeout(e(m))}),me(()=>(e(m),$e(D())),()=>{e(m)&&clearTimeout(e(m)),c(m,setTimeout(()=>{D().trim().length>=20?R(D()):c(a,[])},500))}),Pe();var u={...ze()};Re();var f=rt(),ee=Be(f);{var ie=v=>{var y=bt(),b=r(y),pe=r(b),le=i(r(pe),2),ce=r(le,!0);t(le),t(pe);var be=i(pe,2);{var xe=P=>{var O=pt();_(P,O)};A(()=>J(be,P=>{e(p)&&P(xe)}),"if",V,171,6)}t(b);var te=i(b,2);{var re=P=>{var O=ft();_(P,O)},G=P=>{var O=mt();ut(()=>e(a),ae=>ae.id),A(()=>Ee(O,5,()=>e(a),ae=>ae.id,(ae,$)=>{var K=gt(),de=r(K),ue=r(de),fe=r(ue),ge=r(fe),he=r(ge,!0);t(ge);var ve=i(ge,2),_e=r(ve);t(ve),t(fe);var n=i(fe,2),g=r(n,!0);t(n);var w=i(n,2),o=r(w,!0);t(w);var d=i(w,2),C=r(d);t(d);var H=i(d,2),T=r(H);t(H),t(ue);var se=i(ue,2);t(de);var q=i(de,2),Y=r(q);t(q),t(K),X(Q=>{S(he,(e($),h(()=>e($).type))),S(_e,`${Q??""}% confidence`),S(g,(e($),h(()=>e($).title))),S(o,(e($),h(()=>e($).description))),S(C,`"${e($),h(()=>e($).suggested_text)??""}"`),S(T,`💡 ${e($),h(()=>e($).reasoning)??""}`)},[()=>(e($),h(()=>Math.round(e($).confidence*100)))]),F("click",se,()=>s(e($).id)),F("click",Y,()=>x(e($))),_(ae,K)}),"each",V,183,8),t(O),_(P,O)};A(()=>J(te,P=>{e(p)?P(re):P(G,!1)}),"if",V,176,4)}t(y),X(()=>S(ce,e(p)?"Getting suggestions...":"AI Suggestions")),_(v,y)};A(()=>J(ee,v=>{e(a),e(p),h(()=>e(a).length>0||e(p))&&v(ie)}),"if",V,159,0)}return _(U,f),Ie(u)}const Fe={current:null,saveStatus:"idle",lastSaved:null,errorMessage:null};function xt(){const{subscribe:U,set:B,update:l}=dt(Fe);let D=null,z=null;const a=3e4,p=s=>{try{localStorage.setItem("monitor_draft_current",JSON.stringify(s))}catch(u){console.warn("Failed to save draft to localStorage:",u)}},m=()=>{try{const s=localStorage.getItem("monitor_draft_current");if(s){const u=JSON.parse(s);if(Date.now()-u.timestamp<24*60*60*1e3)return u;localStorage.removeItem("monitor_draft_current")}}catch(s){console.warn("Failed to load draft from localStorage:",s)}return null},R=async s=>{try{const u=await fetch("/api/monitors/drafts/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:s.prompt,timestamp:s.timestamp})});return u.ok?(await u.json()).success===!0:!1}catch(u){return console.error("Failed to save draft to server:",u),!1}},W=s=>{D&&clearTimeout(D),D=setTimeout(async()=>{s.hasUnsavedChanges&&await x(s)},a)},x=async s=>{l(f=>({...f,saveStatus:"saving",errorMessage:null})),p(s);const u=await R(s);l(u?f=>({...f,saveStatus:"saved",lastSaved:Date.now(),current:s?{...s,hasUnsavedChanges:!1,isAutoSaved:!0}:null}):f=>({...f,saveStatus:"error",errorMessage:"Auto-save to server failed, but saved locally",current:s?{...s,hasUnsavedChanges:!1,isAutoSaved:!0}:null})),z=s};return{subscribe:U,initialize:()=>{const s=m();s&&(l(u=>({...u,current:s,lastSaved:s.timestamp})),z=s)},updateDraft:s=>{const u=Date.now(),f={prompt:s,timestamp:u,isAutoSaved:!1,hasUnsavedChanges:!0};l(ee=>{var ie;return{...ee,current:f,saveStatus:((ie=ee.current)==null?void 0:ie.prompt)===s?ee.saveStatus:"idle"}}),z=f,W(f)},save:async()=>{z&&await x(z)},clear:()=>{D&&(clearTimeout(D),D=null),localStorage.removeItem("monitor_draft_current"),l(()=>Fe),z=null},restore:s=>{l(u=>({...u,current:s,saveStatus:"idle",lastSaved:s.timestamp})),z=s},loadServerDrafts:async()=>{try{const s=await fetch("/api/monitors/drafts");if(s.ok)return(await s.json()).drafts||[]}catch(s){console.error("Failed to load server drafts:",s)}return[]},deleteDraft:async s=>{try{return(await fetch("/api/monitors/drafts",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:s})})).ok}catch(u){return console.error("Failed to delete draft:",u),!1}}}}const I=xt(),ke=U=>{const l=Date.now()-U;return l<6e4?"Just now":l<36e5?`${Math.floor(l/6e4)} minutes ago`:l<864e5?`${Math.floor(l/36e5)} hours ago`:new Date(U).toLocaleDateString()};M[k]="src/lib/components/DraftStatus.svelte";var ht=j(L('<span class="text-xs text-orange-600"> </span>'),M[k],[[111,6]]),yt=j(L('<button type="button" class="px-3 py-1 text-xs font-medium text-blue-700 bg-blue-100 border border-blue-300 rounded hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 disabled:opacity-50 disabled:cursor-not-allowed transition-colors svelte-1c3ig4d"> </button>'),M[k],[[120,6]]),_t=j(L('<button type="button" class="px-3 py-1 text-xs font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-1 transition-colors svelte-1c3ig4d" title="Manage drafts">📋 Drafts</button>'),M[k],[[132,6]]),wt=j(L('<div class="bg-white border border-blue-200 rounded p-3 hover:bg-blue-50 transition-colors group"><div class="flex items-start justify-between"><button type="button" class="flex-1 text-left svelte-1c3ig4d"><p class="text-sm text-gray-900 line-clamp-2 mb-1 svelte-1c3ig4d"> </p> <p class="text-xs text-gray-500"> <!></p></button> <button type="button" class="ml-2 p-1 text-gray-400 hover:text-red-600 opacity-0 group-hover:opacity-100 transition-opacity svelte-1c3ig4d" aria-label="Delete draft"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></button></div></div>'),M[k],[[151,8,[[152,10,[[153,12,[[158,14],[161,14]]],[171,12,[[177,14,[[178,16]]]]]]]]]]),St=j(L('<div class="mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg"><h4 class="text-sm font-medium text-blue-900 mb-3">Saved Drafts</h4> <div class="space-y-2 max-h-48 overflow-y-auto"></div></div>'),M[k],[[146,2,[[147,4],[149,4]]]]),kt=j(L('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50" role="dialog" aria-modal="true"><div class="bg-white rounded-lg max-w-md w-full p-6"><h3 class="text-lg font-medium text-gray-900 mb-4">Restore Draft?</h3> <p class="text-sm text-gray-600 mb-4">You have unsaved changes in your current draft. Restoring this draft will replace your current work.</p> <div class="bg-gray-50 rounded p-3 mb-4"><p class="text-sm text-gray-700 line-clamp-3 svelte-1c3ig4d"><strong>Draft to restore:</strong><br/> </p> <p class="text-xs text-gray-500 mt-2"> </p></div> <div class="flex justify-end space-x-3"><button type="button" class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors svelte-1c3ig4d">Cancel</button> <button type="button" class="px-4 py-2 text-sm font-medium text-orange-700 bg-orange-100 border border-orange-300 rounded hover:bg-orange-200 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 transition-colors svelte-1c3ig4d">Discard current</button> <button type="button" class="px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors svelte-1c3ig4d">Restore draft</button></div></div></div>'),M[k],[[190,2,[[191,4,[[192,6],[194,6],[198,6,[[199,8,[[200,10],[200,44]]],[203,8]]],[208,6,[[209,8],[217,8],[225,8]]]]]]]]),Dt=j(L('<div class="flex items-center justify-between p-3 bg-gray-50 border-t border-gray-200 rounded-b-lg"><div class="flex items-center space-x-2 text-sm"><span class="text-lg"> </span> <span> </span> <!></div> <div class="flex items-center space-x-2"><!> <!></div></div> <!> <!>',1),M[k],[[103,0,[[104,2,[[105,4],[106,4]]],[117,2]]]]);function M(U,B){je(new.target),Le(B,!1,M);const l=()=>(Je(I,"draftStore"),qe(I,"$draftStore",D)),[D,z]=Ye(),a=E(),p=E(),m=E(),R=E(),W=Ne();let x=Ae(B,"showDraftManager",12,!1),s=E([]),u=E(!1),f=E(null);He(async()=>{x()&&c(s,(await ne(I.loadServerDrafts()))())});const ee=()=>{I.save()},ie=o=>{e(R)?(c(f,o),c(u,!0)):v(o)},v=o=>{I.restore(o),W("draft-restored",o),c(u,!1),c(f,null)},y=()=>{I.clear(),W("draft-cleared"),c(u,!1),c(f,null)},b=async(o,d)=>{d.stopPropagation(),o.id&&confirm("Delete this draft permanently?")&&(await ne(I.deleteDraft(o.id)))()&&c(s,e(s).filter(H=>ye(H.id,o.id,!1)))},pe=o=>{switch(o){case"saving":return"⏳";case"saved":return"✅";case"error":return"⚠️";default:return"💾"}},le=o=>{switch(o){case"saving":return"Saving...";case"saved":return e(p)?`Saved ${ke(e(p))}`:"Saved";case"error":return"Save failed (saved locally)";default:return e(R)?"Unsaved changes":"Up to date"}},ce=o=>{switch(o){case"saving":return"text-blue-600";case"saved":return"text-green-600";case"error":return"text-orange-600";default:return e(R)?"text-yellow-600":"text-gray-500"}};me(()=>l(),()=>{c(a,l().saveStatus)}),me(()=>l(),()=>{c(p,l().lastSaved)}),me(()=>l(),()=>{c(m,l().current)}),me(()=>e(m),()=>{var o;c(R,((o=e(m))==null?void 0:o.hasUnsavedChanges)??!1)}),Pe();var be={...ze()};Re();var xe=Dt(),te=Be(xe),re=r(te),G=r(re),P=r(G,!0);t(G);var O=i(G,2),ae=r(O,!0);t(O);var $=i(O,2);{var K=o=>{var d=ht(),C=r(d);t(d),X(()=>S(C,`(${l(),h(()=>l().errorMessage)??""})`)),_(o,d)};A(()=>J($,o=>{l(),h(()=>l().errorMessage)&&o(K)}),"if",M,110,4)}t(re);var de=i(re,2),ue=r(de);{var fe=o=>{var d=yt(),C=r(d,!0);t(d),X(()=>{d.disabled=ye(e(a),"saving"),S(C,ye(e(a),"saving")?"Saving...":"Save now")}),F("click",d,ee),_(o,d)};A(()=>J(ue,o=>{e(R)&&o(fe)}),"if",M,119,4)}var ge=i(ue,2);{var he=o=>{var d=_t();F("click",d,()=>x(!x())),_(o,d)};A(()=>J(ge,o=>{x()&&o(he)}),"if",M,131,4)}t(de),t(te);var ve=i(te,2);{var _e=o=>{var d=St(),C=i(r(d),2);A(()=>Ee(C,5,()=>e(s),Ve,(H,T)=>{var se=wt(),q=r(se),Y=r(q),Q=r(Y),oe=r(Q,!0);t(Q);var we=i(Q,2),De=r(we),Te=i(De);{var Xe=Z=>{var Se=Me("· Auto-saved");_(Z,Se)},Ge=Z=>{var Se=Me("· Manually saved");_(Z,Se)};A(()=>J(Te,Z=>{e(T),h(()=>e(T).isAutoSaved)?Z(Xe):Z(Ge,!1)}),"if",M,163,16)}t(we),t(Y);var Ke=i(Y,2);t(q),t(se),X((Z,Se)=>{S(oe,Z),S(De,`${Se??""} `)},[()=>(e(T),h(()=>e(T).prompt.length>80?`${e(T).prompt.substring(0,80)}...`:e(T).prompt)),()=>($e(ke),e(T),h(()=>ke(e(T).timestamp)))]),F("click",Y,()=>ie(e(T))),F("click",Ke,Z=>b(e(T),Z)),_(H,se)}),"each",M,150,6),t(C),t(d),_(o,d)};A(()=>J(ve,o=>{$e(x()),e(s),h(()=>x()&&e(s).length>0)&&o(_e)}),"if",M,145,0)}var n=i(ve,2);{var g=o=>{var d=kt(),C=r(d),H=i(r(C),4),T=r(H),se=i(r(T),2);t(T);var q=i(T,2),Y=r(q);t(q),t(H);var Q=i(H,2),oe=r(Q),we=i(oe,2),De=i(we,2);t(Q),t(C),t(d),X(Te=>{S(se,` ${e(f),h(()=>e(f).prompt)??""}`),S(Y,`Saved ${Te??""}`)},[()=>($e(ke),e(f),h(()=>ke(e(f).timestamp)))]),F("click",oe,()=>{c(u,!1),c(f,null)}),F("click",we,y),F("click",De,()=>e(f)&&v(e(f))),_(o,d)};A(()=>J(n,o=>{e(u)&&e(f)&&o(g)}),"if",M,189,0)}X((o,d,C)=>{S(P,o),We(O,1,d,"svelte-1c3ig4d"),S(ae,C)},[()=>(e(a),h(()=>pe(e(a)))),()=>ot((e(a),h(()=>ce(e(a))))),()=>(e(a),h(()=>le(e(a))))]),_(U,xe);var w=Ie(be);return z(),w}N[k]="src/routes/monitors/create/+page.svelte";var $t=j(L('<div class="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg"><div class="flex items-start space-x-3"><div class="flex-shrink-0"><svg class="w-5 h-5 text-blue-600 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg></div> <div class="flex-1"><h3 class="text-sm font-medium text-blue-900 mb-2">Draft Found</h3> <p class="text-sm text-blue-700 mb-3">You have an unsaved draft from your previous session. Would you like to restore it?</p> <div class="bg-white border border-blue-200 rounded p-3 mb-3"><p class="text-sm text-gray-700 line-clamp-3 svelte-1hgrhnq"> </p> <p class="text-xs text-gray-500 mt-2"> </p></div> <div class="flex space-x-3"><button type="button" class="px-3 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors">Restore draft</button> <button type="button" class="px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors">Start fresh</button></div></div></div></div>'),N[k],[[154,4,[[155,6,[[156,8,[[157,10,[[158,12]]]]],[161,8,[[162,10],[163,10],[166,10,[[167,12],[170,12]]],[174,10,[[175,12],[182,12]]]]]]]]]]),Tt=j(L('<div class="bg-red-50 border border-red-200 rounded-lg p-4"><p class="text-sm text-red-700"> </p></div>'),N[k],[[199,8,[[200,10]]]]),Ct=j(at('<svg class="animate-spin -ml-1 mr-3 h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Creating Monitor...',1),N[k],[[248,12,[[249,14],[250,14]]]]),Mt=j(L('<button type="button" class="text-left p-4 border border-gray-200 rounded-lg hover:border-blue-300 hover:bg-blue-50 transition-colors group"><p class="text-sm text-gray-700 group-hover:text-blue-700"> </p></button>'),N[k],[[273,8,[[278,10]]]]),At=j(L(`<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><div class="mb-8"><nav class="flex" aria-label="Breadcrumb"><ol role="list" class="flex items-center space-x-4"><li><a href="/" class="text-gray-400 hover:text-gray-500"><span class="sr-only">Home</span> Dashboard</a></li> <li><div class="flex items-center"><span class="text-gray-400 mx-4">/</span> <span class="text-gray-900 font-medium">Create Monitor</span></div></li></ol></nav> <h1 class="mt-4 text-3xl font-bold text-gray-900">Create Your Monitor</h1> <p class="mt-2 text-gray-600">Describe what you want to track in plain English</p></div> <!> <div class="bg-white shadow-lg rounded-lg overflow-hidden"><form class="p-6 space-y-6"><!> <div><label for="prompt" class="block text-sm md:text-base font-medium text-gray-700 mb-2">What do you want to monitor?</label> <div class="relative"><textarea id="prompt" name="prompt" rows="4" required placeholder="Describe what you want to track... (e.g., 'Tell me when Tesla stock drops below $200')" class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 resize-none p-4 text-base md:text-sm min-h-[120px] touch-manipulation" style="font-size: 16px; /* Prevents iOS zoom */"></textarea> <div class="absolute bottom-2 right-2 text-xs text-gray-400"> </div></div> <!></div> <div class="flex flex-col-reverse sm:flex-row justify-end space-y-reverse space-y-3 sm:space-y-0 sm:space-x-3"><a href="/" class="w-full sm:w-auto px-6 py-3 sm:px-4 sm:py-2 text-base sm:text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 text-center touch-manipulation min-h-[44px] flex items-center justify-center">Cancel</a> <button type="submit"><!></button></div></form> <!></div> <div class="mt-8"><h3 class="text-lg font-medium text-gray-900 mb-4">Need inspiration? Try these examples:</h3> <div class="grid gap-3 sm:grid-cols-2"></div></div> <div class="mt-8 bg-gray-50 rounded-lg p-6"><h4 class="font-medium text-gray-900 mb-2">Tips for creating great monitors:</h4> <ul class="text-sm text-gray-600 space-y-1"><li>• Be specific about what you want to track (stocks, weather, prices, etc.)</li> <li>• Include trigger conditions (when price drops below X, when it rains for X days)</li> <li>• Use natural language - write like you're talking to a friend</li> <li>• Include locations when relevant (weather, gas prices, local events)</li></ul></div></div>`),N[k],[[128,0,[[130,2,[[131,4,[[132,6,[[133,8,[[134,10,[[135,12]]]]],[139,8,[[140,10,[[141,12],[142,12]]]]]]]]],[148,4],[149,4]]],[196,2,[[197,4,[[205,6,[[206,8],[209,8,[[210,10],[221,10]]]]],[235,6,[[236,8],[242,8]]]]]]],[269,2,[[270,4],[271,4]]],[285,2,[[286,4],[287,4,[[288,6],[289,6],[290,6],[291,6]]]]]]]]);function N(U,B){je(new.target),Le(B,!1,N);const l=()=>(Je(I,"draftStore"),qe(I,"$draftStore",D)),[D,z]=Ye();let a=E(""),p=E(!1),m=E(""),R=E(0);const W=500;let x=E(!1);const s=async()=>{c(p,!0),c(m,"");try{const n=(await ne(fetch("/api/monitors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e(a).substring(0,100)+"...",description:e(a),url:"https://example.com",factType:"text",triggerCondition:'contains "monitor"',notificationMethod:"email"})})))();if(!n.ok){if(ye(n.status,401)){c(m,"Please log in to create monitors");return}const w=(await ne(n.json().catch(()=>({}))))();throw new Error(w.error||`HTTP ${n.status}`)}const g=(await ne(n.json()))();console.log(...Ce("log","Monitor created:",g)),vt&&ct("/")}catch(n){console.error(...Ce("error","Error creating monitor:",n)),c(m,n instanceof Error?n.message:"Failed to create monitor")}finally{c(p,!1)}},u=n=>{const{text:g,type:w}=n.detail;c(a,g),I.updateDraft(e(a)),console.log(...Ce("log",`Applied ${w} suggestion:`,g))},f=n=>{const g=n.detail;c(a,g.prompt),c(x,!1)},ee=()=>{c(a,""),c(x,!1)};He(()=>{I.initialize();const n=l().current;n&&n.prompt.trim().length>0&&(c(x,!0),e(a))}),Ue(()=>{e(a).trim().length>0&&I.updateDraft(e(a))});const ie=["Tell me when Tesla stock drops below $200","Alert me when it's going to rain for 3 days in Seattle","Notify when Bitcoin rises 10% in 24 hours","Let me know when iPhone 15 Pro is back in stock at Apple Store","Track when gas prices in San Francisco drop below $4.50"];me(()=>e(a),()=>{c(R,e(a).length)}),me(()=>(e(a),l(),I),()=>{var n;ye(e(a),((n=l().current)==null?void 0:n.prompt)||"",!1)&&e(a).trim().length>0&&I.updateDraft(e(a))}),Pe();var v={...ze()};Re();var y=At(),b=i(r(y),2);{var pe=n=>{var g=$t(),w=r(g),o=i(r(w),2),d=i(r(o),4),C=r(d),H=r(C,!0);t(C);var T=i(C,2),se=r(T);t(T),t(d);var q=i(d,2),Y=r(q),Q=i(Y,2);t(q),t(o),t(w),t(g),X(oe=>{S(H,(l(),h(()=>l().current.prompt))),S(se,`Saved ${oe??""}`)},[()=>(l(),h(()=>new Date(l().current.timestamp).toLocaleString()))]),F("click",Y,()=>{var oe;c(a,((oe=l().current)==null?void 0:oe.prompt)||""),c(x,!1)}),F("click",Q,()=>{I.clear(),c(x,!1)}),_(n,g)};A(()=>J(b,n=>{e(x),l(),h(()=>e(x)&&l().current)&&n(pe)}),"if",N,153,2)}var le=i(b,2),ce=r(le),be=r(ce);{var xe=n=>{var g=Tt(),w=r(g),o=r(w,!0);t(w),t(g),X(()=>S(o,e(m))),_(n,g)};A(()=>J(be,n=>{e(m)&&n(xe)}),"if",N,198,6)}var te=i(be,2),re=i(r(te),2),G=r(re);st(G),nt(G,"maxlength",W);var P=i(G,2),O=r(P);t(P),t(re);var ae=i(re,2);A(()=>V(ae,{get error(){return e(m)},get prompt(){return e(a)},set prompt(n){c(a,n)},$$events:{"apply-suggestion":u},$$legacy:!0}),"component",N,227,8,{componentTag:"AIPromptSuggestions"}),t(te);var $=i(te,2),K=i(r($),2),de=r(K);{var ue=n=>{var g=Ct();Oe(),_(n,g)},fe=n=>{var g=Me("Create Monitor");_(n,g)};A(()=>J(de,n=>{e(p)?n(ue):n(fe,!1)}),"if",N,247,10)}t(K),t($),t(ce);var ge=i(ce,2);A(()=>M(ge,{showDraftManager:!0,$$events:{"draft-restored":f,"draft-cleared":ee}}),"component",N,261,4,{componentTag:"DraftStatus"}),t(le);var he=i(le,2),ve=i(r(he),2);A(()=>Ee(ve,5,()=>ie,Ve,(n,g)=>{var w=Mt(),o=r(w),d=r(o);t(o),t(w),X(()=>S(d,`"${e(g)??""}"`)),F("click",w,()=>c(a,e(g))),_(n,w)}),"each",N,272,6),t(ve),t(he),Oe(2),t(y),X((n,g)=>{S(O,`${e(R)??""}/500`),K.disabled=n,We(K,1,`w-full sm:w-auto px-6 py-3 sm:px-4 sm:py-2 text-base sm:text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 touch-manipulation min-h-[44px] flex items-center justify-center ${g??""}`)},[()=>(e(p),e(a),h(()=>e(p)||e(a).trim().length<10)),()=>(e(p),e(a),h(()=>e(p)||e(a).trim().length<10?"opacity-50 cursor-not-allowed":""))]),it(G,()=>e(a),n=>c(a,n)),F("submit",ce,lt(s)),_(U,y);var _e=Ie(v);return z(),_e}export{N as component};
