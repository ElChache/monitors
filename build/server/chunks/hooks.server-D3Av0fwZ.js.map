{"version":3,"file":"hooks.server-D3Av0fwZ.js","sources":["../../../.svelte-kit/adapter-node/chunks/hooks.server.js"],"sourcesContent":["import { json } from \"@sveltejs/kit\";\nconst rateLimitMap = /* @__PURE__ */ new Map();\nconst handle = async ({ event, resolve }) => {\n  const { url, request } = event;\n  if (url.pathname.startsWith(\"/api/\")) {\n    const ip = event.getClientAddress();\n    const key = `${ip}:api`;\n    const now = Date.now();\n    const windowMs = 60 * 1e3;\n    const maxRequests = 100;\n    const current = rateLimitMap.get(key);\n    if (current && now < current.resetTime) {\n      if (current.count >= maxRequests) {\n        return json(\n          { error: \"Rate limit exceeded\" },\n          {\n            status: 429,\n            headers: {\n              \"X-RateLimit-Limit\": maxRequests.toString(),\n              \"X-RateLimit-Remaining\": \"0\",\n              \"X-RateLimit-Reset\": Math.ceil(current.resetTime / 1e3).toString()\n            }\n          }\n        );\n      }\n      current.count++;\n    } else {\n      rateLimitMap.set(key, { count: 1, resetTime: now + windowMs });\n    }\n  }\n  const response = await resolve(event);\n  response.headers.set(\"X-Content-Type-Options\", \"nosniff\");\n  response.headers.set(\"X-Frame-Options\", \"DENY\");\n  response.headers.set(\"Access-Control-Allow-Origin\", \"*\");\n  if (url.pathname.startsWith(\"/api/\")) {\n    const ip = event.getClientAddress();\n    const key = `${ip}:api`;\n    const current = rateLimitMap.get(key);\n    if (current) {\n      response.headers.set(\"X-RateLimit-Limit\", \"100\");\n      response.headers.set(\"X-RateLimit-Remaining\", (100 - current.count).toString());\n      response.headers.set(\"X-RateLimit-Reset\", Math.ceil(current.resetTime / 1e3).toString());\n    }\n  }\n  return response;\n};\nexport {\n  handle\n};\n"],"names":[],"mappings":";;AACA,MAAM,YAAY,mBAAmB,IAAI,GAAG,EAAE;AACzC,MAAC,MAAM,GAAG,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK;AAC7C,EAAE,MAAM,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,KAAK;AAChC,EAAE,IAAI,GAAG,CAAC,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE;AACxC,IAAI,MAAM,EAAE,GAAG,KAAK,CAAC,gBAAgB,EAAE;AACvC,IAAI,MAAM,GAAG,GAAG,CAAC,EAAE,EAAE,CAAC,IAAI,CAAC;AAC3B,IAAI,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,EAAE;AAC1B,IAAI,MAAM,QAAQ,GAAG,EAAE,GAAG,GAAG;AAC7B,IAAI,MAAM,WAAW,GAAG,GAAG;AAC3B,IAAI,MAAM,OAAO,GAAG,YAAY,CAAC,GAAG,CAAC,GAAG,CAAC;AACzC,IAAI,IAAI,OAAO,IAAI,GAAG,GAAG,OAAO,CAAC,SAAS,EAAE;AAC5C,MAAM,IAAI,OAAO,CAAC,KAAK,IAAI,WAAW,EAAE;AACxC,QAAQ,OAAO,IAAI;AACnB,UAAU,EAAE,KAAK,EAAE,qBAAqB,EAAE;AAC1C,UAAU;AACV,YAAY,MAAM,EAAE,GAAG;AACvB,YAAY,OAAO,EAAE;AACrB,cAAc,mBAAmB,EAAE,WAAW,CAAC,QAAQ,EAAE;AACzD,cAAc,uBAAuB,EAAE,GAAG;AAC1C,cAAc,mBAAmB,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,GAAG,CAAC,CAAC,QAAQ;AAC9E;AACA;AACA,SAAS;AACT,MAAM;AACN,MAAM,OAAO,CAAC,KAAK,EAAE;AACrB,IAAI,CAAC,MAAM;AACX,MAAM,YAAY,CAAC,GAAG,CAAC,GAAG,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,SAAS,EAAE,GAAG,GAAG,QAAQ,EAAE,CAAC;AACpE,IAAI;AACJ,EAAE;AACF,EAAE,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,KAAK,CAAC;AACvC,EAAE,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,wBAAwB,EAAE,SAAS,CAAC;AAC3D,EAAE,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,iBAAiB,EAAE,MAAM,CAAC;AACjD,EAAE,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,6BAA6B,EAAE,GAAG,CAAC;AAC1D,EAAE,IAAI,GAAG,CAAC,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE;AACxC,IAAI,MAAM,EAAE,GAAG,KAAK,CAAC,gBAAgB,EAAE;AACvC,IAAI,MAAM,GAAG,GAAG,CAAC,EAAE,EAAE,CAAC,IAAI,CAAC;AAC3B,IAAI,MAAM,OAAO,GAAG,YAAY,CAAC,GAAG,CAAC,GAAG,CAAC;AACzC,IAAI,IAAI,OAAO,EAAE;AACjB,MAAM,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,mBAAmB,EAAE,KAAK,CAAC;AACtD,MAAM,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,uBAAuB,EAAE,CAAC,GAAG,GAAG,OAAO,CAAC,KAAK,EAAE,QAAQ,EAAE,CAAC;AACrF,MAAM,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,mBAAmB,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,GAAG,CAAC,CAAC,QAAQ,EAAE,CAAC;AAC9F,IAAI;AACJ,EAAE;AACF,EAAE,OAAO,QAAQ;AACjB;;;;"}